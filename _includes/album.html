<div class="container">
  <!-- Navigation Box 유지 -->
  <div class="box">
      <h2 class="title is-4">Album Categories</h2>
      <ul>
          {% for category in site.data.album.categories %}
              <li><a href="#{{ category.id | slugify }}">{{ category.name }}</a></li>
          {% endfor %}
      </ul>
  </div>

  <!-- categories Section -->
  {% for categories in site.data.categories %}
      <h2 class="title is-3" id="{{ categories.id | slugify }}">{{ categories.name }}</h2>
      <div class="columns is-multiline">
          {% for item in categories.images %}
          <!-- 한 줄에 4개 사진 배치 -->
              <div class="column is-one-quarter"> 
                  <div class="card">
                      <!-- 이미지 슬라이드 (캐러셀) -->
                      <div class="slideshow-container" data-index="0">
                          <!-- 여러 장의 이미지 삽입 -->
                          {% for image in item.image_list %}
                              <div class="slide fade">
                                  <img src="{{ image.link }}" alt="{{ image.alt }}" style="width:100%">
                              </div>
                          {% endfor %}

                          <!-- 좌우 버튼 추가 -->
                          <a class="prev" onclick="changeSlide(this, -1)">&#10094;</a>
                          <a class="next" onclick="changeSlide(this, 1)">&#10095;</a>
                      </div>

                      <div class="card-content">
                          <p class="title is-5">
                              <a href="{{ item.link }}" target="_blank">{{ item.description }}</a>
                          </p>
                          <p class="subtitle is-6">{{ item.date }}</p>
                      </div>
                  </div>
              </div>
          {% endfor %}
      </div>
  {% endfor %}
</div>

<!-- 캐러셀(Slideshow) 스크립트 (자동전환 없음, 버튼 클릭 방식) -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  let slideshows = document.querySelectorAll(".slideshow-container");

  slideshows.forEach((slideshow) => {
      let slides = slideshow.querySelectorAll(".slide");
      let slideIndex = 0; // 첫 번째 이미지부터 시작

      // 첫 번째 이미지만 표시
      slides.forEach((slide, i) => {
          slide.style.display = (i === 0) ? "block" : "none";
      });

      slideshow.dataset.index = slideIndex; // 현재 인덱스 저장
  });
});

// 슬라이드 변경 함수 (이전/다음 버튼)
function changeSlide(button, n) {
  let slideshow = button.parentElement;
  let slides = slideshow.querySelectorAll(".slide");
  let slideIndex = parseInt(slideshow.dataset.index);

  // 슬라이드 인덱스 변경
  slideIndex += n;
  if (slideIndex >= slides.length) { slideIndex = 0; }  // 마지막 이미지에서 다음 클릭하면 처음으로
  if (slideIndex < 0) { slideIndex = slides.length - 1; } // 첫 번째 이미지에서 이전 클릭하면 마지막으로

  // 모든 이미지 숨기고, 해당 인덱스의 이미지만 표시
  slides.forEach((slide, i) => {
      slide.style.display = (i === slideIndex) ? "block" : "none";
  });

  slideshow.dataset.index = slideIndex; // 현재 인덱스 업데이트
}
</script>

<style>
/* 슬라이드 스타일 */
.slideshow-container {
  position: relative;
  max-width: 100%;
  height: 200px;
  overflow: hidden;
}

/* 이미지 슬라이드 기본 숨김 */
.slide {
  display: none;
  width: 100%;
}

/* 좌우 버튼 스타일 */
.prev, .next {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  cursor: pointer;
  background-color: rgba(0, 0, 0, 0.5);
  color: white;
  padding: 8px 12px;
  font-size: 18px;
  border-radius: 5px;
}

.prev { left: 5px; }
.next { right: 5px; }

.prev:hover, .next:hover {
  background-color: rgba(0, 0, 0, 0.8);
}
</style>
